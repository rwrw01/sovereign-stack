<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sovereign Infrastructure â€” Security Architecture</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'IBM Plex Sans', sans-serif;
    background: #0d1117;
    color: #c9d1d9;
    min-height: 100vh;
    padding: 32px;
  }

  .page {
    max-width: 1600px;
    margin: 0 auto;
  }

  header {
    margin-bottom: 32px;
    border-bottom: 2px solid #21262d;
    padding-bottom: 24px;
  }

  header h1 {
    font-size: 22px;
    font-weight: 700;
    color: #e6edf3;
    letter-spacing: -0.3px;
    margin-bottom: 6px;
  }

  header .subtitle {
    font-size: 13px;
    color: #8b949e;
    font-family: 'IBM Plex Mono', monospace;
  }

  .legend {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 28px;
    padding: 16px 20px;
    background: #161b22;
    border: 1px solid #21262d;
    border-radius: 6px;
  }

  .legend-section {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .legend-section h3 {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #8b949e;
    font-weight: 600;
    margin-bottom: 2px;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #c9d1d9;
  }

  .legend-swatch {
    width: 14px;
    height: 14px;
    border-radius: 3px;
    flex-shrink: 0;
  }

  .legend-line {
    width: 28px;
    height: 3px;
    border-radius: 1px;
    flex-shrink: 0;
  }

  .legend-line-dashed {
    width: 28px;
    height: 0;
    border-top: 2px dashed;
    flex-shrink: 0;
  }

  .diagram-container {
    background: #0d1117;
    border: 1px solid #21262d;
    border-radius: 8px;
    overflow-x: auto;
    padding: 8px;
  }

  svg {
    display: block;
    margin: 0 auto;
  }

  .principles {
    margin-top: 28px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 12px;
  }

  .principle {
    background: #161b22;
    border: 1px solid #21262d;
    border-radius: 6px;
    padding: 14px 18px;
  }

  .principle h3 {
    font-size: 12px;
    font-weight: 600;
    color: #e6edf3;
    margin-bottom: 4px;
  }

  .principle p {
    font-size: 11px;
    color: #8b949e;
    line-height: 1.5;
  }

  .footer-meta {
    margin-top: 24px;
    padding-top: 16px;
    border-top: 1px solid #21262d;
    display: flex;
    justify-content: space-between;
    font-size: 11px;
    color: #484f58;
    font-family: 'IBM Plex Mono', monospace;
  }
</style>
</head>
<body>
<div class="page">

<header>
  <h1>Sovereign Infrastructure â€” Beveiligingsarchitectuur</h1>
  <div class="subtitle">Hetzner cax31 Â· Zero Trust Â· Assume Breach Â· Defense in Depth</div>
</header>

<div class="legend">
  <div class="legend-section">
    <h3>Beveiligingszones</h3>
    <div class="legend-item"><div class="legend-swatch" style="background:#da3633;opacity:0.2;border:1.5px solid #da3633"></div>Internet (untrusted)</div>
    <div class="legend-item"><div class="legend-swatch" style="background:#d29922;opacity:0.15;border:1.5px solid #d29922"></div>Proxy-netwerk (DMZ)</div>
    <div class="legend-item"><div class="legend-swatch" style="background:#1f6feb;opacity:0.12;border:1.5px solid #1f6feb"></div>Stack-intern netwerk</div>
    <div class="legend-item"><div class="legend-swatch" style="background:#238636;opacity:0.15;border:1.5px solid #238636"></div>VPN-only (control plane)</div>
  </div>
  <div class="legend-section">
    <h3>Netwerken</h3>
    <div class="legend-item"><div class="legend-line" style="background:#d29922"></div>proxy (extern, HTTP)</div>
    <div class="legend-item"><div class="legend-line" style="background:#a371f7"></div>net-auth (intern, OIDC)</div>
    <div class="legend-item"><div class="legend-line" style="background:#1f6feb"></div>stack-intern (geÃ¯soleerd)</div>
    <div class="legend-item"><div class="legend-line-dashed" style="border-color:#da3633"></div>direct host-port (mail)</div>
  </div>
  <div class="legend-section">
    <h3>Toegang</h3>
    <div class="legend-item"><div class="legend-swatch" style="background:#238636"></div>Publiek</div>
    <div class="legend-item"><div class="legend-swatch" style="background:#da3633"></div>VPN + MFA + credentials</div>
    <div class="legend-item"><div class="legend-swatch" style="background:#d29922"></div>VPN only</div>
  </div>
</div>

<div class="diagram-container">
<svg viewBox="0 0 1440 1070" width="1440" height="1070" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#484f58"/>
    </marker>
    <marker id="arrow-orange" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#d29922"/>
    </marker>
    <marker id="arrow-purple" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#a371f7"/>
    </marker>
    <marker id="arrow-red" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#da3633"/>
    </marker>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- ===== BACKGROUND ===== -->
  <rect width="1440" height="1070" fill="#0d1117" rx="8"/>

  <!-- ===== INTERNET ZONE ===== -->
  <rect x="20" y="10" width="1400" height="70" rx="6" fill="#da3633" fill-opacity="0.06" stroke="#da3633" stroke-opacity="0.3" stroke-width="1.5"/>
  <text x="40" y="36" font-family="IBM Plex Mono, monospace" font-size="11" fill="#da3633" font-weight="600">INTERNET (UNTRUSTED)</text>
  <text x="40" y="56" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Gebruikers Â· Crawlers Â· Aanvallers</text>

  <!-- Internet actors -->
  <g transform="translate(700, 26)">
    <rect x="0" y="0" width="90" height="32" rx="4" fill="#21262d" stroke="#da3633" stroke-opacity="0.4"/>
    <text x="45" y="20" text-anchor="middle" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9">Clients</text>
  </g>
  <g transform="translate(820, 26)">
    <rect x="0" y="0" width="110" height="32" rx="4" fill="#21262d" stroke="#da3633" stroke-opacity="0.4"/>
    <text x="55" y="20" text-anchor="middle" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9">Mail Servers</text>
  </g>

  <!-- ===== UFW FIREWALL BAR ===== -->
  <rect x="20" y="90" width="1400" height="36" rx="4" fill="#b3261e" fill-opacity="0.12" stroke="#da3633" stroke-opacity="0.5" stroke-width="2"/>
  <text x="40" y="113" font-family="IBM Plex Mono, monospace" font-size="11" fill="#ff7b72" font-weight="600">UFW FIREWALL</text>
  <text x="220" y="113" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Poorten: 22 Â· 80 Â· 443 Â· 25 Â· 465 Â· 587 Â· 993 Â· 4190 Â· 41641/udp â€” Legacy (110/143/995) localhost-only</text>

  <!-- ===== LUKS ENCRYPTION BAR ===== -->
  <rect x="20" y="136" width="1400" height="24" rx="3" fill="#a371f7" fill-opacity="0.06" stroke="#a371f7" stroke-opacity="0.25" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="40" y="152" font-family="IBM Plex Mono, monospace" font-size="10" fill="#a371f7" font-weight="500">LUKS VERSLEUTELD VOLUME â€” /opt (data-at-rest encryptie)</text>

  <!-- ===== HEADSCALE VPN OVERLAY ===== -->
  <rect x="1180" y="90" width="230" height="36" rx="4" fill="#238636" fill-opacity="0.15" stroke="#238636" stroke-opacity="0.5" stroke-width="1.5"/>
  <text x="1200" y="113" font-family="IBM Plex Mono, monospace" font-size="10" fill="#3fb950" font-weight="600">HEADSCALE VPN (100.64.0.0/10)</text>

  <!-- ===== PROXY ZONE (DMZ) ===== -->
  <rect x="30" y="170" width="1380" height="100" rx="6" fill="#d29922" fill-opacity="0.04" stroke="#d29922" stroke-opacity="0.25" stroke-width="1.5" stroke-dasharray="6,3"/>
  <text x="50" y="190" font-family="IBM Plex Mono, monospace" font-size="10" fill="#d29922" font-weight="600">PROXY NETWERK (gedeeld, extern) â€” alleen HTTP-routing</text>

  <!-- TRAEFIK -->
  <g transform="translate(60, 200)">
    <rect width="200" height="56" rx="5" fill="#161b22" stroke="#d29922" stroke-opacity="0.6"/>
    <text x="14" y="22" font-family="IBM Plex Sans" font-size="12" fill="#e6edf3" font-weight="600">Traefik v2.11</text>
    <text x="14" y="40" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">TLS termination Â· :80 :443</text>
    <circle cx="186" cy="14" r="5" fill="#238636"/>
  </g>

  <!-- Socket Proxy (internal to traefik) -->
  <g transform="translate(290, 200)">
    <rect width="160" height="56" rx="5" fill="#161b22" stroke="#1f6feb" stroke-opacity="0.4" stroke-dasharray="3,2"/>
    <text x="12" y="22" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9" font-weight="500">Socket Proxy</text>
    <text x="12" y="40" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">Docker API (RO)</text>
  </g>
  <!-- socket-proxy internal link -->
  <line x1="260" y1="228" x2="290" y2="228" stroke="#1f6feb" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="268" y="222" font-family="IBM Plex Mono, monospace" font-size="8" fill="#1f6feb">net-socket</text>

  <!-- ===== STACK ZONES (below proxy) ===== -->

  <!-- ====== KEYCLOAK STACK ====== -->
  <rect x="30" y="285" width="340" height="260" rx="6" fill="#1f6feb" fill-opacity="0.04" stroke="#1f6feb" stroke-opacity="0.2" stroke-width="1.5"/>
  <text x="48" y="305" font-family="IBM Plex Mono, monospace" font-size="10" fill="#1f6feb" font-weight="600">STACK: KEYCLOAK â€” /opt/keycloak/</text>

  <!-- Keycloak app -->
  <g transform="translate(50, 315)">
    <rect width="180" height="54" rx="5" fill="#161b22" stroke="#58a6ff" stroke-opacity="0.5"/>
    <text x="12" y="20" font-family="IBM Plex Sans" font-size="12" fill="#e6edf3" font-weight="600">Keycloak 26.x</text>
    <text x="12" y="36" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">SSO Â· OIDC Â· MFA(TOTP)</text>
    <circle cx="166" cy="12" r="4" fill="#238636" title="public: /realms"/>
    <circle cx="152" cy="12" r="4" fill="#da3633" title="admin: VPN only"/>
  </g>

  <!-- oauth2-proxy -->
  <g transform="translate(50, 380)">
    <rect width="180" height="44" rx="5" fill="#161b22" stroke="#a371f7" stroke-opacity="0.4"/>
    <text x="12" y="18" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9" font-weight="500">oauth2-proxy v7.6</text>
    <text x="12" y="34" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">Forward Auth Â· RBAC</text>
  </g>

  <!-- PG Keycloak (internal) -->
  <g transform="translate(50, 440)">
    <rect width="180" height="44" rx="5" fill="#161b22" stroke="#1f6feb" stroke-opacity="0.35" stroke-dasharray="3,2"/>
    <text x="12" y="18" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9" font-weight="500">PostgreSQL 16</text>
    <text x="12" y="34" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">kc-internal Â· geen internet</text>
  </g>

  <!-- kc-internal link -->
  <line x1="140" y1="369" x2="140" y2="440" stroke="#1f6feb" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="148" y="410" font-family="IBM Plex Mono, monospace" font-size="8" fill="#1f6feb">kc-internal</text>

  <!-- Secrets indicator -->
  <g transform="translate(250, 440)">
    <rect width="100" height="44" rx="4" fill="#21262d" stroke="#484f58" stroke-dasharray="2,2"/>
    <text x="10" y="17" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922">ðŸ”‘ secrets/</text>
    <text x="10" y="33" font-family="IBM Plex Mono, monospace" font-size="8" fill="#484f58">chmod 700</text>
  </g>

  <!-- ====== GHOST STACK ====== -->
  <rect x="385" y="285" width="260" height="260" rx="6" fill="#1f6feb" fill-opacity="0.04" stroke="#1f6feb" stroke-opacity="0.2" stroke-width="1.5"/>
  <text x="403" y="305" font-family="IBM Plex Mono, monospace" font-size="10" fill="#1f6feb" font-weight="600">STACK: GHOST â€” /opt/ghost/</text>

  <!-- Ghost app -->
  <g transform="translate(405, 315)">
    <rect width="220" height="54" rx="5" fill="#161b22" stroke="#58a6ff" stroke-opacity="0.5"/>
    <text x="12" y="20" font-family="IBM Plex Sans" font-size="12" fill="#e6edf3" font-weight="600">Ghost 5.x</text>
    <text x="12" y="36" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">CMS Â· example.com</text>
    <circle cx="200" cy="12" r="4" fill="#238636" title="public: website"/>
    <circle cx="186" cy="12" r="4" fill="#da3633" title="admin: VPN+MFA+auth"/>
  </g>

  <!-- MariaDB Ghost -->
  <g transform="translate(405, 400)">
    <rect width="220" height="44" rx="5" fill="#161b22" stroke="#1f6feb" stroke-opacity="0.35" stroke-dasharray="3,2"/>
    <text x="12" y="18" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9" font-weight="500">MariaDB 11</text>
    <text x="12" y="34" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">ghost-internal Â· geen internet</text>
  </g>

  <!-- ghost-internal link -->
  <line x1="515" y1="369" x2="515" y2="400" stroke="#1f6feb" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="522" y="388" font-family="IBM Plex Mono, monospace" font-size="8" fill="#1f6feb">ghost-int</text>

  <!-- Ghost secrets -->
  <g transform="translate(405, 460)">
    <rect width="100" height="44" rx="4" fill="#21262d" stroke="#484f58" stroke-dasharray="2,2"/>
    <text x="10" y="17" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922">ðŸ”‘ secrets/</text>
    <text x="10" y="33" font-family="IBM Plex Mono, monospace" font-size="8" fill="#484f58">chmod 700</text>
  </g>

  <!-- IMPORTANT: Ghost has NO net-auth access -->
  <g transform="translate(405, 516)">
    <rect width="220" height="20" rx="3" fill="#da3633" fill-opacity="0.1" stroke="#da3633" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Mono, monospace" font-size="9" fill="#ff7b72">â›” Geen net-auth toegang</text>
  </g>

  <!-- ====== NEXTCLOUD STACK ====== -->
  <rect x="660" y="285" width="300" height="310" rx="6" fill="#1f6feb" fill-opacity="0.04" stroke="#1f6feb" stroke-opacity="0.2" stroke-width="1.5"/>
  <text x="678" y="305" font-family="IBM Plex Mono, monospace" font-size="10" fill="#1f6feb" font-weight="600">STACK: NEXTCLOUD â€” /opt/nextcloud/</text>

  <!-- Nextcloud app -->
  <g transform="translate(680, 315)">
    <rect width="260" height="54" rx="5" fill="#161b22" stroke="#58a6ff" stroke-opacity="0.5"/>
    <text x="12" y="20" font-family="IBM Plex Sans" font-size="12" fill="#e6edf3" font-weight="600">Nextcloud 30.x</text>
    <text x="12" y="36" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">Bestanden Â· Agenda Â· Contacten</text>
    <circle cx="244" cy="12" r="4" fill="#238636" title="public"/>
  </g>

  <!-- PG Nextcloud -->
  <g transform="translate(680, 385)">
    <rect width="180" height="44" rx="5" fill="#161b22" stroke="#1f6feb" stroke-opacity="0.35" stroke-dasharray="3,2"/>
    <text x="12" y="18" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9" font-weight="500">PostgreSQL 16</text>
    <text x="12" y="34" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">nc-internal Â· geen internet</text>
  </g>

  <!-- Redis -->
  <g transform="translate(680, 445)">
    <rect width="180" height="44" rx="5" fill="#161b22" stroke="#1f6feb" stroke-opacity="0.35" stroke-dasharray="3,2"/>
    <text x="12" y="18" font-family="IBM Plex Sans" font-size="11" fill="#c9d1d9" font-weight="500">Redis 7</text>
    <text x="12" y="34" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">nc-cache Â· geen internet</text>
  </g>

  <!-- nc-internal link -->
  <line x1="770" y1="369" x2="770" y2="385" stroke="#1f6feb" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="778" y="380" font-family="IBM Plex Mono, monospace" font-size="8" fill="#1f6feb">nc-int</text>

  <!-- nc-cache link -->
  <line x1="770" y1="429" x2="770" y2="445" stroke="#1f6feb" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="778" y="440" font-family="IBM Plex Mono, monospace" font-size="8" fill="#1f6feb">nc-cache</text>

  <!-- NC secrets -->
  <g transform="translate(680, 505)">
    <rect width="100" height="44" rx="4" fill="#21262d" stroke="#484f58" stroke-dasharray="2,2"/>
    <text x="10" y="17" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922">ðŸ”‘ secrets/</text>
    <text x="10" y="33" font-family="IBM Plex Mono, monospace" font-size="8" fill="#484f58">chmod 700</text>
  </g>

  <!-- ====== MAILCOW STACK ====== -->
  <rect x="975" y="285" width="435" height="355" rx="6" fill="#1f6feb" fill-opacity="0.04" stroke="#1f6feb" stroke-opacity="0.2" stroke-width="1.5"/>
  <text x="993" y="305" font-family="IBM Plex Mono, monospace" font-size="10" fill="#1f6feb" font-weight="600">STACK: MAILCOW â€” /opt/mailcow-dockerized/</text>

  <!-- Mailcow Nginx (in proxy) -->
  <g transform="translate(995, 315)">
    <rect width="180" height="44" rx="5" fill="#161b22" stroke="#d29922" stroke-opacity="0.5"/>
    <text x="12" y="18" font-family="IBM Plex Sans" font-size="11" fill="#e6edf3" font-weight="600">Nginx (proxy)</text>
    <text x="12" y="34" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">mail.example.com</text>
    <circle cx="164" cy="12" r="4" fill="#238636"/>
    <circle cx="150" cy="12" r="4" fill="#d29922" title="admin: VPN"/>
  </g>

  <!-- Mailcow internal components -->
  <rect x="990" y="372" width="410" height="145" rx="4" fill="#0d1117" stroke="#30363d"/>
  <text x="1005" y="390" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">Mailcow intern netwerk (geÃ¯soleerd)</text>

  <g transform="translate(1005, 400)">
    <rect width="110" height="36" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="8" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Postfix</text>
    <text x="8" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">SMTP :25 :587</text>
  </g>

  <g transform="translate(1125, 400)">
    <rect width="110" height="36" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="8" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Dovecot</text>
    <text x="8" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">IMAP :993</text>
  </g>

  <g transform="translate(1245, 400)">
    <rect width="110" height="36" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="8" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Rspamd</text>
    <text x="8" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Antispam</text>
  </g>

  <g transform="translate(1005, 446)">
    <rect width="110" height="36" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="8" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">ClamAV</text>
    <text x="8" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Antivirus</text>
  </g>

  <g transform="translate(1125, 446)">
    <rect width="110" height="36" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="8" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">SOGo</text>
    <text x="8" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Webmail</text>
  </g>

  <g transform="translate(1245, 446)">
    <rect width="110" height="36" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="8" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">MariaDB</text>
    <text x="8" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">+ Redis</text>
  </g>

  <!-- Direct host ports indicator -->
  <g transform="translate(995, 530)">
    <rect width="395" height="30" rx="4" fill="#da3633" fill-opacity="0.08" stroke="#da3633" stroke-opacity="0.3" stroke-dasharray="4,2"/>
    <text x="12" y="19" font-family="IBM Plex Mono, monospace" font-size="9" fill="#ff7b72">Direct host-poorten: 25 Â· 465 Â· 587 Â· 993 Â· 4190 (niet via Traefik)</text>
  </g>

  <!-- DNS records indicator -->
  <g transform="translate(995, 572)">
    <rect width="395" height="50" rx="4" fill="#161b22" stroke="#30363d"/>
    <text x="12" y="17" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">DNS: MX Â· SPF Â· DKIM Â· DMARC Â· MTA-STS</text>
    <text x="12" y="33" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">DMARC: none â†’ quarantine (wk3) â†’ reject (mnd3)</text>
    <text x="12" y="45" font-family="IBM Plex Mono, monospace" font-size="8" fill="#484f58">âš  Hetzner poort 25: support-ticket vereist</text>
  </g>

  <!-- ====== PROXY NETWORK CONNECTIONS (metro-style) ====== -->
  <!-- Horizontal bus line at y=276 -->
  <line x1="140" y1="276" x2="1085" y2="276" stroke="#d29922" stroke-width="2"/>
  <!-- Bus label -->
  <rect x="540" y="266" width="100" height="14" rx="3" fill="#0d1117"/>
  <text x="551" y="277" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922" font-weight="500">proxy netwerk</text>

  <!-- Traefik trunk down to bus -->
  <line x1="160" y1="256" x2="160" y2="276" stroke="#d29922" stroke-width="2"/>
  <!-- Horizontal segment on bus to first drop -->
  <circle cx="160" cy="276" r="3" fill="#d29922"/>

  <!-- Drop: bus â†’ Keycloak -->
  <circle cx="140" cy="276" r="3" fill="#d29922"/>
  <line x1="140" y1="276" x2="140" y2="315" stroke="#d29922" stroke-width="2" marker-end="url(#arrow-orange)"/>

  <!-- Drop: bus â†’ Ghost -->
  <circle cx="515" cy="276" r="3" fill="#d29922"/>
  <line x1="515" y1="276" x2="515" y2="315" stroke="#d29922" stroke-width="2" marker-end="url(#arrow-orange)"/>

  <!-- Drop: bus â†’ Nextcloud -->
  <circle cx="810" cy="276" r="3" fill="#d29922"/>
  <line x1="810" y1="276" x2="810" y2="315" stroke="#d29922" stroke-width="2" marker-end="url(#arrow-orange)"/>

  <!-- Drop: bus â†’ Mailcow nginx -->
  <circle cx="1085" cy="276" r="3" fill="#d29922"/>
  <line x1="1085" y1="276" x2="1085" y2="315" stroke="#d29922" stroke-width="2" marker-end="url(#arrow-orange)"/>

  <!-- ====== NET-AUTH CONNECTIONS (metro-style, under Ghost) ====== -->
  <!-- Keycloak â†’ Nextcloud (net-auth): exits KC right, drops down through gutter, under Ghost, up into NC -->
  <path d="M230,342 L377,342 L377,558 L655,558 L655,342 L680,342" 
        fill="none" stroke="#a371f7" stroke-width="2.5" marker-end="url(#arrow-purple)"/>
  <!-- Junction dots -->
  <circle cx="230" cy="342" r="3" fill="#a371f7"/>
  <circle cx="377" cy="342" r="3" fill="#a371f7"/>
  <circle cx="377" cy="558" r="3" fill="#a371f7"/>
  <circle cx="655" cy="558" r="3" fill="#a371f7"/>
  <circle cx="655" cy="342" r="3" fill="#a371f7"/>
  <!-- Label on bottom horizontal segment -->
  <rect x="460" y="548" width="80" height="16" rx="3" fill="#0d1117"/>
  <text x="466" y="560" font-family="IBM Plex Mono, monospace" font-size="9" fill="#a371f7" font-weight="500">net-auth</text>

  <!-- oauth2-proxy on net-auth -->
  <line x1="140" y1="380" x2="140" y2="380" stroke="#a371f7" stroke-width="0"/>
  <text x="248" y="398" font-family="IBM Plex Mono, monospace" font-size="8" fill="#a371f7">â†• net-auth + proxy</text>

  <!-- ====== MONITORING ZONE ====== -->
  <rect x="30" y="665" width="350" height="130" rx="6" fill="#238636" fill-opacity="0.04" stroke="#238636" stroke-opacity="0.2" stroke-width="1.5"/>
  <text x="48" y="685" font-family="IBM Plex Mono, monospace" font-size="10" fill="#3fb950" font-weight="600">MONITORING & SCANNING</text>

  <g transform="translate(50, 700)">
    <rect width="140" height="36" rx="4" fill="#161b22" stroke="#238636" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Falco</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Runtime anomaly detect</text>
  </g>

  <g transform="translate(200, 700)">
    <rect width="140" height="36" rx="4" fill="#161b22" stroke="#238636" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Node Exporter</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">CPU Â· RAM Â· Disk</text>
  </g>

  <g transform="translate(50, 745)">
    <rect width="140" height="36" rx="4" fill="#161b22" stroke="#238636" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Trivy</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Wekelijks imagescan</text>
  </g>

  <g transform="translate(200, 745)">
    <rect width="140" height="36" rx="4" fill="#161b22" stroke="#238636" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">CIS Benchmark</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Docker audit</text>
  </g>

  <!-- ====== BACKUP ZONE ====== -->
  <rect x="400" y="665" width="360" height="130" rx="6" fill="#d29922" fill-opacity="0.04" stroke="#d29922" stroke-opacity="0.2" stroke-width="1.5"/>
  <text x="418" y="685" font-family="IBM Plex Mono, monospace" font-size="10" fill="#d29922" font-weight="600">BACKUP (3-2-1 REGEL)</text>

  <g transform="translate(420, 700)">
    <rect width="150" height="36" rx="4" fill="#161b22" stroke="#d29922" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">GPG Asymmetrisch</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">Pub key op server</text>
  </g>

  <g transform="translate(580, 700)">
    <rect width="160" height="36" rx="4" fill="#161b22" stroke="#d29922" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Google Drive (offsite)</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">rclone sync Â· GPG encrypted</text>
  </g>

  <g transform="translate(420, 745)">
    <rect width="150" height="36" rx="4" fill="#161b22" stroke="#d29922" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Hetzner Snapshots</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">VPS rollback</text>
  </g>

  <g transform="translate(580, 745)">
    <rect width="160" height="36" rx="4" fill="#161b22" stroke="#d29922" stroke-opacity="0.3"/>
    <text x="10" y="14" font-family="IBM Plex Sans" font-size="10" fill="#c9d1d9" font-weight="500">Retentie</text>
    <text x="10" y="28" font-family="IBM Plex Mono, monospace" font-size="8" fill="#8b949e">30d lokaal Â· 90d offsite</text>
  </g>

  <!-- ====== ACCESS CONTROL MATRIX ====== -->
  <rect x="30" y="815" width="1380" height="240" rx="6" fill="#161b22" stroke="#21262d" stroke-width="1.5"/>
  <text x="50" y="840" font-family="IBM Plex Mono, monospace" font-size="11" fill="#e6edf3" font-weight="600">TOEGANGSCONTROLE â€” DATA PLANE vs CONTROL PLANE</text>

  <!-- Table header -->
  <line x1="50" y1="853" x2="1390" y2="853" stroke="#30363d"/>
  <text x="60" y="870" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e" font-weight="600">SERVICE / PAD</text>
  <text x="440" y="870" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e" font-weight="600">TOEGANG</text>
  <text x="760" y="870" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e" font-weight="600">BEVEILIGING</text>
  <line x1="50" y1="877" x2="1390" y2="877" stroke="#30363d"/>

  <!-- Rows -->
  <text x="60" y="897" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">example.com</text>
  <rect x="440" y="885" width="60" height="18" rx="3" fill="#238636" fill-opacity="0.2" stroke="#238636" stroke-opacity="0.4"/>
  <text x="452" y="898" font-family="IBM Plex Mono, monospace" font-size="9" fill="#3fb950">Publiek</text>
  <text x="760" y="897" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">TLS + Security Headers + Rate Limit</text>

  <text x="60" y="921" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">example.com/ghost (admin)</text>
  <rect x="440" y="909" width="125" height="18" rx="3" fill="#da3633" fill-opacity="0.2" stroke="#da3633" stroke-opacity="0.4"/>
  <text x="448" y="922" font-family="IBM Plex Mono, monospace" font-size="9" fill="#ff7b72">VPN+MFA+Auth</text>
  <text x="760" y="921" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Headscale â†’ Keycloak TOTP â†’ oauth2-proxy â†’ Ghost login</text>

  <text x="60" y="945" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">auth.example.com/realms/*</text>
  <rect x="440" y="933" width="60" height="18" rx="3" fill="#238636" fill-opacity="0.2" stroke="#238636" stroke-opacity="0.4"/>
  <text x="452" y="946" font-family="IBM Plex Mono, monospace" font-size="9" fill="#3fb950">Publiek</text>
  <text x="760" y="945" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">OIDC flow (Nextcloud login)</text>

  <text x="60" y="969" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">auth.example.com/admin/*</text>
  <rect x="440" y="957" width="70" height="18" rx="3" fill="#d29922" fill-opacity="0.2" stroke="#d29922" stroke-opacity="0.4"/>
  <text x="450" y="970" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922">VPN only</text>
  <text x="760" y="969" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Headscale VPN (100.64.0.0/10 whitelist)</text>

  <text x="60" y="993" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">cloud.example.com</text>
  <rect x="440" y="981" width="60" height="18" rx="3" fill="#238636" fill-opacity="0.2" stroke="#238636" stroke-opacity="0.4"/>
  <text x="452" y="994" font-family="IBM Plex Mono, monospace" font-size="9" fill="#3fb950">Publiek</text>
  <text x="760" y="993" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Keycloak OIDC + MFA (TOTP)</text>

  <text x="60" y="1017" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">mail.example.com/admin</text>
  <rect x="440" y="1005" width="70" height="18" rx="3" fill="#d29922" fill-opacity="0.2" stroke="#d29922" stroke-opacity="0.4"/>
  <text x="450" y="1018" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922">VPN only</text>
  <text x="760" y="1017" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Headscale VPN whitelist</text>

  <text x="60" y="1041" font-family="IBM Plex Mono, monospace" font-size="10" fill="#c9d1d9">traefik.example.com</text>
  <rect x="440" y="1029" width="70" height="18" rx="3" fill="#d29922" fill-opacity="0.2" stroke="#d29922" stroke-opacity="0.4"/>
  <text x="450" y="1042" font-family="IBM Plex Mono, monospace" font-size="9" fill="#d29922">VPN only</text>
  <text x="760" y="1041" font-family="IBM Plex Mono, monospace" font-size="10" fill="#8b949e">Headscale VPN whitelist Â· geen extern zichtbaar</text>

  <!-- ====== HARDENING ANNOTATIONS ====== -->
  <rect x="780" y="665" width="630" height="130" rx="6" fill="#161b22" stroke="#21262d"/>
  <text x="798" y="685" font-family="IBM Plex Mono, monospace" font-size="10" fill="#e6edf3" font-weight="600">CONTAINER HARDENING BASELINE â€” CIS Score: 32/117</text>
  <text x="798" y="705" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">âœ“ no-new-privileges Â· cap_drop: ALL Â· seccomp: default Â· apparmor: docker-default</text>
  <text x="798" y="721" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">âœ“ Specifieke user (non-root) per container Â· memory + pids limits Â· healthchecks</text>
  <text x="798" y="737" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">âœ“ read_only filesystem (waar mogelijk) Â· restart: on-failure:5 Â· icc: false</text>
  <text x="798" y="753" font-family="IBM Plex Mono, monospace" font-size="9" fill="#8b949e">âœ“ Docker Content Trust Â· Gepinde image-versies Â· auditd Â· Geen :latest tags</text>
  <text x="798" y="771" font-family="IBM Plex Mono, monospace" font-size="9" fill="#da3633">âš  Rootless Docker niet mogelijk (Mailcow) â€” compensatie: per-container hardening</text>
  <text x="798" y="787" font-family="IBM Plex Mono, monospace" font-size="9" fill="#da3633">âš  Falco draait privileged â€” compensatie: read-only, geen netwerktoegang</text>

</svg>
</div>

<div class="principles">
  <div class="principle">
    <h3>Zero Trust</h3>
    <p>Elk component wantrouwt elk ander component. Geen impliciet vertrouwen op basis van netwerklocatie. Authenticatie en autorisatie op elke laag.</p>
  </div>
  <div class="principle">
    <h3>Assume Breach</h3>
    <p>Compromise van Ã©Ã©n stack geeft geen toegang tot andere stacks. Databases zijn onzichtbaar buiten hun eigen stack. Secrets zijn geÃ¯soleerd per service.</p>
  </div>
  <div class="principle">
    <h3>Defense in Depth</h3>
    <p>Meerdere beveiligingslagen: UFW â†’ Traefik â†’ VPN whitelist â†’ Keycloak MFA â†’ oauth2-proxy RBAC â†’ service-eigen authenticatie. Falen van Ã©Ã©n laag is niet fataal.</p>
  </div>
  <div class="principle">
    <h3>Data Plane / Control Plane Scheiding</h3>
    <p>Publieke diensten via internet. Admin-interfaces uitsluitend via Headscale VPN. Port scan onthult geen admin-panelen â€” ze "bestaan niet" voor de buitenwereld.</p>
  </div>
</div>

<div class="footer-meta">
  <span>Sovereign Infrastructure Â· Hetzner cax31 (16GB, 8 vCPU, 160GB) Â· ARM64</span>
  <span>~7.7GB / 15.5GB geheugen Â· 50% headroom</span>
</div>

</div>
</body>
</html>
